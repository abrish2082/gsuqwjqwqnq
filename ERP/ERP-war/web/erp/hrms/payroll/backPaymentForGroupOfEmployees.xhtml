<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    template="../../../resources/templates/template.xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="navigaion_content">
        <li><a href="payLocationPayGroupSetup.xhtml"><i class="fa fa-fw"></i>Pay Location &amp; Pay Group Setup</a></li>
        <li><a href="payLocationPayGroup.xhtml"><i class="fa fa-fw"></i>Pay Location Pay Group Mapping with Department</a></li>
        <li><a href="payrollTaxRateRegistration.xhtml"><i class="fa fa-fw"></i> Tax Rate Entry</a></li>
        <li><a href="pensionRateEntry.xhtml"><i class="fa fa-fw"></i>Pension Rate Entry</a></li>
        <li><a href="earningDeductionSetupTabTest.xhtml"><i class="fa fa-fw"></i>Earnings/Deductions</a></li>
        <li><a href="payrollPeriod.xhtml"><i class="fa fa-fw"></i>Payroll Period</a> </li>
        <li><a href="EmpEarningDeductionTabTest.xhtml"><i class="fa fa-fw"></i>Employees Earning Deduction</a></li>
        <li><a href="EmpEarningDeductionUsingGroup.xhtml"><i class="fa fa-fw"></i>All Employees Earning Deduction</a></li>        
        <li><a href="ThirdPartiesInfo.xhtml"><i class="fa fa-fw"></i>Maintain Third party Info</a></li>
        <li><a href="generateMonthlyPayroll.xhtml"><i class="fa fa-fw"></i>Generate Monthly Payroll</a> </li>      
        <li><a href="generatePayrollReports.xhtml"><i class="fa fa-fw"></i>Payroll Report</a> </li>
        <li><a href="backPaymentGroup.xhtml"><i class="fa fa-fw"></i>Create Payroll Group</a></li>
        <li><a href="backPaymentForGroupOfEmployees.xhtml"><i class="fa fa-fw"></i>Back Payment using Group</a> </li>        
        <li><a href="leaveAdvancePayment.xhtml"><i class="fa fa-fw"></i>Leave Advance</a> </li>
    </ui:define>
    <ui:define name="contents">
        <h:form id="frmHeader"> 
            <p:toolbar style="background-color:white;border-color: white">
                <f:facet name="right">
                    <span class="ui-separator">
                        <span class="ui-icon ui-icon-grip-dotted-vertical"/>
                    </span>
                    <a href="../../hrms/payroll/backPaymentForGroupOfEmployees.xhtml"><i class="fa fa-fw fa-refresh" title="Refresh"></i></a>
                    <span class="ui-separator">
                        <span class="ui-icon ui-icon-grip-dotted-vertical"/>
                    </span>
                    <a href="../../hrms/hrmsDashboard.xhtml"><i class="fa fa-fw fa-dashboard" title="Dashboard"></i></a>
                    <span class="ui-separator">
                        <span class="ui-icon ui-icon-grip-dotted-vertical"/>
                    </span>
                    <a href="../../../HomePage.xhtml"><i class="fa fa-home" title="Home Page"></i></a>
                    <span class="ui-separator">
                        <span class="ui-icon ui-icon-grip-dotted-vertical"/>
                    </span>
                </f:facet>
            </p:toolbar>
        </h:form> 
        <p:growl id="growl1" showDetail="true" autoUpdate="true" severity="information"/>
        <div class="row">
            <div class="col-md-12">
                <div class="box box-primary collapsed-box">
                    <div class="box-header">
                        <h3 class="box-title">List of Earnings</h3>
                        <!-- tools box -->
                        <div class="pull-right box-tools">
                            <button class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Expand"><i class="fa fa-plus"></i></button>
                        </div><!-- /. tools -->
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body ">
                        <h:form id="frmEarningDeductionLists">
                            <section class="panel panel-info">
                                <div class="box-header">                                                    
                                    <h1 class="box-title"></h1>                       
                                </div>
                                <section class="panel-body">
                                    <div class="form-group" >
                                        <div class="col-sm-18" >
                                            <div class="col-sm-4" > 
                                                <div class="col-md-12 ">
                                                    <p:outputLabel>List of Earnings</p:outputLabel>
                                                    <div class="col-sm-16"> 
                                                        <p:dataTable id="chkListOfUngroupedEd" var="bk" value="#{generateGroupBackPayment.listOfEarningDeductions}"  
                                                                     selection="#{generateGroupBackPayment.listOfSelectedEarnings}" scrollable="true" scrollHeight="200"
                                                                     rowKey="#{bk}" style="margin-bottom:0">
                                                            <p:column selectionMode="multiple"  style="width:30px;text-align:left"/>
                                                            <p:column headerText="Earnings" filterBy="#{bk.description}" filterMatchMode="startsWith" >
                                                                <h:outputText value="#{bk.description}" style="float:left"/>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </div>
                                                </div>                                                    
                                            </div>
                                            <div class="col-sm-2" > 
                                                <div class="col-md-20 ">
                                                    <br></br>
                                                    <br></br>
                                                    <br></br>
                                                    <div class="col-sm-20"> 
                                                        <p:commandButton id="btnSavex"  action="#{generateGroupBackPayment.saveEarningDeductionForBackPaymt()}"
                                                                         process=":frmEarningDeductionLists" update=":frmEarningDeductionLists"  
                                                                         class="btn  btn-primary col-sm-12"   value="#{generateGroupBackPayment.iconAdd}"/>
                                                    </div> 
                                                    <br></br>
                                                    <br></br>
                                                    <div class="col-sm-20">  
                                                        <p:commandButton id="btnAddAllx" action="#{generateGroupBackPayment.removeEarningDeductionForBackPymt()}" 
                                                                         process=":frmEarningDeductionLists"  update=":frmEarningDeductionLists"  
                                                                         class="btn  btn-primary col-sm-12" value="#{generateGroupBackPayment.iconRemove}"/>
                                                    </div>                                                       
                                                </div>                          
                                            </div>
                                            <div class="form-group" >
                                                <div class="col-sm-18" >
                                                    <div class="col-sm-4" > 
                                                        <div class="col-md-12 ">
                                                            <p:outputLabel>List of earning for back payment</p:outputLabel>
                                                            <div class="col-sm-16">                                                             
                                                                <p:dataTable id="chkListOfGroupedEd" var="filteredBp" value="#{generateGroupBackPayment.listOfBackPayment}"  
                                                                             scrollable="true" scrollHeight="200"
                                                                             rowKey="#{filteredBp}" style="margin-bottom:0" 
                                                                             selection="#{generateGroupBackPayment.listOfFiltedBackPayment}" >

                                                                    <p:column selectionMode="multiple"  style="width:30px;text-align:left"/>
                                                                    <p:column headerText="Name"  filterBy="#{filteredBp.earningDedId.description}" filterMatchMode="startsWith" >
                                                                        <h:outputText value="#{filteredBp.earningDedId.description}" style="float:left"/>
                                                                    </p:column>
                                                                </p:dataTable>
                                                            </div>
                                                        </div>                                                    
                                                    </div>
                                                </div>                                                    
                                            </div>
                                        </div>                                                    
                                    </div>
                                    <div class="box-info">
                                    </div>
                                </section>
                            </section>
                        </h:form>

                    </div>
                </div>
            </div>
        </div>
        <!--- start of grouping empl-->
        <div class="row">
            <div class="col-md-12">
                <div class="box box-primary collapsed-box">
                    <div class="box-header">
                        <h3 class="box-title">List of employees</h3>
                        <!-- tools box -->
                        <div class="pull-right box-tools">
                            <button class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Expand"><i class="fa fa-plus"></i></button>
                        </div><!-- /. tools -->
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body ">
                        <h:form id="frmPayrollPeriod">
                            <section class="panel panel-info">
                                <div class="box-header">
                                    <h1 class="box-title"></h1>                       
                                </div>
                                <section class="panel-body">
                                    <div class="col-md-12 ">
                                        <div class="form-group form-horizontal">
                                            <div class="col-sm-8"> 
                                            </div>
                                        </div>
                                    </div>
                                    <br></br>
                                    <br></br>
                                    <div class="col-md-12 ">
                                        <div class="form-group form-horizontal">
                                            <div class="col-sm-8"> 
                                            </div>                                                          
                                        </div>  
                                    </div> 
                                    <br></br>
                                    <br></br>
                                    <div class="col-md-12 textBoxMargin6px">
                                        <div class="form-group form-horizontal">                                                                               
                                            <div class="col-sm-8">
                                            </div>                                                            
                                        </div>
                                    </div>
                                    <div class="form-group" >
                                        <div class="col-sm-18" >
                                            <div class="col-sm-4" > 
                                                <div class="col-md-12 ">
                                                    <p:outputLabel>List of Employees</p:outputLabel>
                                                    <div class="col-sm-16"> 
                                                        <p:dataTable id="checkboxDT" var="bk" value="#{generateGroupBackPayment.listOfEmployees}" 
                                                                     rowIndexVar="num" selection="#{generateGroupBackPayment.listOfEmpForPayment}"
                                                                     scrollable="true" scrollHeight="200" rowKey="#{bk.id}" style="margin-bottom:0">

                                                            <p:column selectionMode="multiple"  style="width:40px;text-align:left"/>

                                                            <p:column  style="width:40px;text-align:left">
                                                                <f:facet name="header">
                                                                    <h:outputText value="" />
                                                                </f:facet>
                                                                <h:outputText value="#{num+1}"/>
                                                            </p:column>  

                                                            <p:column headerText="Name" filterBy="#{bk.firstName}" filterMatchMode="startsWith" >
                                                                <h:outputText value="#{bk.firstName} #{bk.middleName} #{bk.lastName}" style="float:left"/>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </div>
                                                </div>                                                    
                                            </div>
                                            <div class="col-sm-2" > 
                                                <div class="col-md-20 ">
                                                    <br></br>
                                                    <br></br>
                                                    <br></br>
                                                    <div class="col-sm-20"> 
                                                        <p:commandButton id="btnSavex"  action="#{generateGroupBackPayment.filterEmployeeForBackPytm()}"
                                                                         process=":frmPayrollPeriod" update=":frmPayrollPeriod"  class="btn  btn-primary col-sm-12"  
                                                                         value="#{generateGroupBackPayment.iconAdd}"/>
                                                    </div> 
                                                    <br></br>
                                                    <br></br>
                                                    <div class="col-sm-20">  
                                                        <p:commandButton  id="btnAddAllx"  action="#{generateGroupBackPayment.removeFilteredEmployeesForBackPytnt()}" 
                                                                          process=":frmPayrollPeriod" update=":frmPayrollPeriod" class="btn  btn-primary col-sm-12"  
                                                                          value="#{generateGroupBackPayment.iconRemove}"/>
                                                    </div>                                                       
                                                </div>                          
                                            </div>
                                            <div class="form-group" >
                                                <div class="col-sm-18" >
                                                    <div class="col-sm-4" > 
                                                        <div class="col-md-12 ">
                                                            <p:outputLabel>List Of Employees For Payment</p:outputLabel>
                                                            <div class="col-sm-16">                                                             
                                                                <p:dataTable id="chekAfter" var="filteredBp" value="#{generateGroupBackPayment.listOfFilteredEmployees}" 
                                                                             scrollable="true" scrollHeight="200"
                                                                             rowIndexVar="num"   rowKey="#{filteredBp.id}" style="margin-bottom:0" 
                                                                             selection="#{generateGroupBackPayment.filterBk}" >
                                                                    <p:column selectionMode="multiple"  style="width:40px;text-align:left"/>

                                                                    <p:column  style="width:40px;text-align:left">
                                                                        <f:facet name="header">
                                                                            <h:outputText value="" />
                                                                        </f:facet>
                                                                        <h:outputText value="#{num+1}"/>
                                                                    </p:column> 

                                                                    <p:column headerText="Name"  filterBy="#{filteredBp.firstName}" filterMatchMode="startsWith"  >
                                                                        <h:outputText value="#{filteredBp.firstName} #{filteredBp.middleName} #{filteredBp.lastName}" 
                                                                                      style="float:left"/>
                                                                    </p:column>
                                                                </p:dataTable>
                                                            </div>
                                                        </div>                                                    
                                                    </div>
                                                </div>                                                    
                                            </div>

                                        </div>                                                    
                                    </div>
                                    <div class="box-info">
                                    </div>
                                </section>
                            </section>
                        </h:form>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="box box-primary ">                   
                    <div class="box-body ">                     
                        <div class="box-body ">                            
                            <h:form id="dtpanel2222">
                                <section class="panel panel-info">
                                    <section class="panel-body">
                                        <div class="col-md-6">
                                            <div class="form-group form-horizontal required">
                                                <h:outputLabel value="Back Payment Group:"  class="control-label col-sm-4"/>
                                                <div class="col-sm-6"> 
                                                    <p:selectOneMenu id="drpBkGroup" required="true" 
                                                                     requiredMessage="Select Payement" style="width:100%"  
                                                                     valueChangeListener="#{generateGroupBackPayment.handleValueChangePayrollGroup}"  
                                                                     value="#{generateGroupBackPayment.hrPayrollBackPaymentGroups.id}" >
                                                        <p:ajax listener="#{generateGroupBackPayment.handleGroupchange}" update="tblEmployeesForBk"/>
                                                        <f:selectItem itemLabel="--Select One--" itemValue="#{null}"/>
                                                        <f:selectItems itemLabel="#{ bkGroup.groupName}" itemValue="#{bkGroup.id}" 
                                                                       var="bkGroup" value="#{generateGroupBackPayment.listOfPayrollGrops}"/>
                                                    </p:selectOneMenu>
                                                </div>
                                            </div>  
                                        </div>
                                        <br></br>
                                        <br></br>
                                        <div class="col-md-6">
                                            <div class="col-md-4">
                                            </div>
                                            <div class="col-sm-6"> 
                                                <p:commandButton  id="btnSave" action="#{generateGroupBackPayment.generateBackPayment()}" 
                                                                  update="@(form)" class="btn  btn-primary col-sm-8"  
                                                                  value="Generate Back Payment"/>
                                            </div>
                                        </div>  
                                    </section>
                                </section>
                                <section class="panel panel-info">
                                    <section class="panel-body">
                                        <p:dialog widgetVar="dlgSteps"  resizable="false" dynamic="true" id="dispDialogs" 
                                                  header="#{generateGroupBackPayment.backPayedEmployees.firstName} #{generateGroupBackPayment.backPayedEmployees.middleName} #{generateGroupBackPayment.backPayedEmployees.lastName}" 
                                                  style="width:50%; top:150px; height: 40px">
                                            <p:panel style="width: 850px; height: 450px; overflow: scroll">
                                                <p:dataTable id="tblearnDed2"   rowIndexVar="num"   var="indBk"  
                                                             value="#{generateGroupBackPayment.istOfDetailMaintanedBackPays}">
                                                    <p:column width="60">
                                                        <f:facet name="header"  >
                                                            <h:outputText  value="Month"/>
                                                        </f:facet>
                                                        <h:outputText value="#{generatePayroll.getReturnYM(indBk.prevPayrllId.paymentMadeForTheMonthOf)}" 
                                                                      style="font-weight: bold"/>
                                                    </p:column>  
                                                    <p:column width="250">
                                                        <f:facet name="header"  >
                                                            <h:outputText  value="Transaction"/>
                                                        </f:facet>
                                                        <h:outputText value="#{indBk.earningDedCode.description}" style="float:left"/>
                                                    </p:column>  
                                                    <p:column >
                                                        <f:facet name="header" >
                                                            <h:outputText value="Old Value"/>
                                                        </f:facet>
                                                        <h:outputText value="#{indBk.prevAmt}"/>
                                                    </p:column>  
                                                    <p:column >
                                                        <f:facet name="header" >
                                                            <h:outputText value="New Value"/>
                                                        </f:facet>
                                                        <h:outputText value="#{indBk.newAmt}"/>
                                                    </p:column>  
                                                    <p:column >
                                                        <f:facet name="header" >
                                                            <h:outputText value="Difference"/>
                                                        </f:facet>
                                                        <h:outputText value="#{indBk.monthlyAmount}"/>
                                                    </p:column>  
                                                    <p:column >
                                                        <f:facet name="header" >
                                                            <h:outputText value="Length of Month"/>
                                                        </f:facet>
                                                        <h:outputText value="#{indBk.numberOfMonth}"/>
                                                    </p:column> 
                                                    <p:column >
                                                        <f:facet name="header" >
                                                            <h:outputText value="(Difference *Length of Month)"/>
                                                        </f:facet>
                                                        <h:outputText value="#{indBk.totalAmount}"/>
                                                    </p:column>
                                                </p:dataTable> 
                                            </p:panel>
                                        </p:dialog>
                                        <p:dataTable id="tblEmployeesForBk"  rowIndexVar="num"  rows="18"  var="backPay"  paginator="true" 
                                                     paginatorPosition="bottom"
                                                     value="#{generateGroupBackPayment.listOfBackPayedEmployees}">
                                            <p:column  width="60">
                                                <f:facet name="header">
                                                    <h:outputText value="S.NO"/>
                                                </f:facet>
                                                <h:outputText value="#{num+1}"/>
                                            </p:column>                     
                                            <p:column>
                                                <f:facet name="header">
                                                    <h:outputText value="Full Name"/>
                                                </f:facet>
                                                <h:outputText style="float:left" value="#{backPay.firstName} #{backPay.middleName} #{backPay.lastName}"/>
                                            </p:column>
                                            <p:column headerText="Option" style="width:100px;text-align: center">
                                                <p:commandLink  immediate="true" value="View" oncomplete="PF('dlgSteps').show()" update="@(form)"  
                                                                action="#{generateGroupBackPayment.displayOnDialog()}" >
                                                    <f:setPropertyActionListener value="#{backPay}"  target="#{generateGroupBackPayment.backPayedEmployees}"/>
                                                </p:commandLink>
                                            </p:column>
                                        </p:dataTable> 
                                    </section>
                                </section>
                            </h:form>
                        </div>                        
                    </div>                        
                </div> 
            </div>
        </div>
    </ui:define>
</ui:composition>
